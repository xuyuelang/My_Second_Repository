# My_Second_Repository
北邮自动请假脚本
北邮自动请假小程序
By Lambertlang

前言：为应用之前学的Python和了解一下selenium，结合目前的防疫操作，整一个出校请假小程序，目前是雏形初具，可以实现简易的打卡，后续完善的点在第三部分。仅供参考。

一.基于selenium自动化测试
1.安装Python，pip，安装selenium包
此处可能会遇到未知原因的错误，请关掉代理即可。
2.Chromedriver与浏览器版本号一致
3.使用pytest框架
4.使用远程主机定时打卡或者本地Windows计划任务定时
每天7：50自动执行一次脚本
50 7 * * * /usr/bin/python3 /home/lxy/auto.py

二.问题及解决
序号	遇到的问题	对应解决方法
1	下拉框元素定位问题	输入元素搜索，点击第一个元素确认
2	时间控件元素难以输入	删除只读属性，直接js格式化输入
3	弹窗的确定按钮无法定位	被遮挡定位不到，使用键盘ENTER
4	诡异元素无法定位	切换定位方法，键鼠配合操作
5	元素不在页面内	滑动页面至元素出现

三.不足之处：
1.未判断已登录场景
2.未对网络连通性进行判断，健壮性一般
3.未使用显示等待和隐式等待，单纯使用sleep延时，效率较低
4.后续可以升级邮件&发送操作日志
5.后续可以对程序健壮性进行升级（加入登录判断和网络判断）
6.后续加入异常捕获和断言

注意：
1.Windows下的python脚本与Linux的编码需要区分
2.定时程序可以使用pyinstaller来生成EXE文件，也可以直接用.bat执行，但是要注意包和依赖的问题
3.纯属学习娱乐，如有雷同，绝对是巧合。部分方法来源于网络及selenium官网
